
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Class04 &#8212; Database and Data Management</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/nameko.css" />
    <link rel="stylesheet" type="text/css" href="_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Class05" href="class05.html" />
    <link rel="prev" title="Class03" href="class03.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="class05.html" title="Class05"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="class03.html" title="Class03"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Database and Data Management</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Class04</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="class04">
<h1>Class04<a class="headerlink" href="#class04" title="Permalink to this headline">¶</a></h1>
<section id="datastream">
<h2>Datastream<a class="headerlink" href="#datastream" title="Permalink to this headline">¶</a></h2>
<section id="overview">
<h3>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Another important data platform for accounting and finance research</p></li>
<li><p>Useful for international research</p></li>
<li><p>A product offered by Refinitiv (formerly known as Thomson Reuters)</p></li>
</ul>
</section>
<section id="access">
<h3>Access<a class="headerlink" href="#access" title="Permalink to this headline">¶</a></h3>
<section id="where-to-find-eikon-terminal">
<h4>Where to find Eikon terminal<a class="headerlink" href="#where-to-find-eikon-terminal" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li><p>Terminal in CASIF office</p></li>
<li><p>Bloomberg trading room (LUBS Room 1.30)</p></li>
</ul>
</section>
<section id="how-to-login">
<h4>How to login<a class="headerlink" href="#how-to-login" title="Permalink to this headline">¶</a></h4>
<p>1. Open Excel</p>
<p>2. Click <strong>REFINITIV EIKON</strong></p>
<p>3. Click <strong>Sign In</strong></p>
<p><img alt="" src="https://raw.githubusercontent.com/mk0417/image-lib/master/ds_login.png" /></p>
<p>4. <strong>Online</strong> means successful login</p>
<p><img alt="" src="https://raw.githubusercontent.com/mk0417/image-lib/master/ds_online.png" /></p>
<p>5. Click <strong>REFINITIV EIKON DATASTREAM</strong></p>
<p><img alt="" src="https://raw.githubusercontent.com/mk0417/image-lib/master/ds_datastream.png" /></p>
</section>
</section>
<section id="company-list">
<h3>Company list<a class="headerlink" href="#company-list" title="Permalink to this headline">¶</a></h3>
<section id="how-to-screen-company-list">
<h4>How to screen company list<a class="headerlink" href="#how-to-screen-company-list" title="Permalink to this headline">¶</a></h4>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>DS symbol</p></th>
<th class="head"><p>CUSIP</p></th>
<th class="head"><p>ISIN</p></th>
<th class="head"><p>Primary</p></th>
<th class="head"><p>Major</p></th>
<th class="head"><p>Exchange</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ALPHABET INC</p></td>
<td><p>&#64;GOOGL</p></td>
<td><p>02079K305</p></td>
<td><p>US02079K3059</p></td>
<td><p>P</p></td>
<td><p>Y</p></td>
<td><p>Nasdaq</p></td>
</tr>
<tr class="row-odd"><td><p>ALPHABET INC</p></td>
<td><p>D:ABEA</p></td>
<td><p>02079K305</p></td>
<td><p>US02079K3059</p></td>
<td><p>S</p></td>
<td><p>Y</p></td>
<td><p>Frankfurt</p></td>
</tr>
<tr class="row-even"><td><p>ALPHABET INC</p></td>
<td><p>0RIH</p></td>
<td><p>02079K305</p></td>
<td><p>US02079K3059</p></td>
<td><p>S</p></td>
<td><p>Y</p></td>
<td><p>London</p></td>
</tr>
<tr class="row-odd"><td><p>ALPHABET INC</p></td>
<td><p>&#64;GOOG</p></td>
<td><p>02079K107</p></td>
<td><p>US02079K3059</p></td>
<td><p>P</p></td>
<td><p>N</p></td>
<td><p>Nasdaq</p></td>
</tr>
</tbody>
</table>
<p><dbvar>Primary</dbvar> = <varvalue>P</varvalue> and <dbvar>Major</dbvar> = <varvalue>Y</varvalue>
will keep the firm below:</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>DS symbol</p></th>
<th class="head"><p>CUSIP</p></th>
<th class="head"><p>ISIN</p></th>
<th class="head"><p>Primary</p></th>
<th class="head"><p>Major</p></th>
<th class="head"><p>Exchange</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ALPHABET INC</p></td>
<td><p>&#64;GOOGL</p></td>
<td><p>02079K305</p></td>
<td><p>US02079K3059</p></td>
<td><p>P</p></td>
<td><p>Y</p></td>
<td><p>Nasdaq</p></td>
</tr>
</tbody>
</table>
<dl>
<dt><dbvar>Primary</dbvar>
<dd>ISINID returns either P or S where P indicates that the equity record is the primary one (i.e.,
the domestic listing of the share or depository receipt or certificate), and where S indicates that
the equity record is secondary (i.e., a foreign listing of a share or depository receipt or certificate).
</dl>
<dl>
<dt><dbvar>Major</dbvar>
<dd>For companies with more than one equity Security MAJOR returns Y (yes) or N (no) to indicate
which of the securities is the most significant in terms of market value and liquidity of the
primary quotation of that security. Only one security per company is assigned as the major, and all
quotations of that security will return a Y value. All quotations of other securities will return
N. For Companies with only one equity security, all the quotations of that security will return Y.
</dl>
</section>
<section id="company-list-from-other-database">
<h4>Company list from other database<a class="headerlink" href="#company-list-from-other-database" title="Permalink to this headline">¶</a></h4>
<p>You are able to use your own list if you have firm list from some other databases (for example, you
may have a list from Compustat). Acceptable identifiers include:</p>
<ul class="simple">
<li><p>CUSIP. Please remember to add leading <strong>U</strong>, e.g. U02079K305</p></li>
<li><p>ISIN</p></li>
<li><p>IBES ticker</p></li>
</ul>
</section>
</section>
<section id="static-data">
<h3>Static data<a class="headerlink" href="#static-data" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Example: company identifiers</p></li>
</ul>
</section>
<section id="time-series-data">
<h3>Time series data<a class="headerlink" href="#time-series-data" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Example: stock price</p></li>
</ul>
<p>Stock price of Tesco</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>date</p></th>
<th class="head"><p>P</p></th>
<th class="head"><p>P#S</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>12/20/2021</p></td>
<td><p>287.6</p></td>
<td><p>287.6</p></td>
</tr>
<tr class="row-odd"><td><p>12/21/2021</p></td>
<td><p>288.5</p></td>
<td><p>288.5</p></td>
</tr>
<tr class="row-even"><td><p>12/22/2021</p></td>
<td><p>287.55</p></td>
<td><p>287.55</p></td>
</tr>
<tr class="row-odd"><td><p>12/23/2021</p></td>
<td><p>288.35</p></td>
<td><p>288.35</p></td>
</tr>
<tr class="row-even"><td><p>12/24/2021</p></td>
<td><p>287.9</p></td>
<td><p>287.9</p></td>
</tr>
<tr class="row-odd"><td><p><strong>12/27/2021</strong></p></td>
<td><p><strong>287.9</strong></p></td>
<td><p><strong>NA</strong></p></td>
</tr>
<tr class="row-even"><td><p><strong>12/28/2021</strong></p></td>
<td><p><strong>287.9</strong></p></td>
<td><p><strong>NA</strong></p></td>
</tr>
<tr class="row-odd"><td><p>12/29/2021</p></td>
<td><p>291.05</p></td>
<td><p>291.05</p></td>
</tr>
<tr class="row-even"><td><p>12/30/2021</p></td>
<td><p>291.25</p></td>
<td><p>291.25</p></td>
</tr>
<tr class="row-odd"><td><p>12/31/2021</p></td>
<td><p>289.9</p></td>
<td><p>289.9</p></td>
</tr>
</tbody>
</table>
<p>27 Dec 2021 and 28 Dec 2021 are non-trading days (holidays) in UK. The price will repeat last
availabe price on holidays if you choose <dbvar>P</dbvar> to download stock price. You can use
<dbvar>P#S</dbvar> to avoid this.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>You can read this article to get better understanding of the difference
<a class="weblink" href="https://bizlib247.wordpress.com/2012/04/13/datastream-price-variables-p-ps-pt/" target="_blank">Datastream – Price variables</a></p>
</div>
</section>
<section id="data-format">
<h3>Data format<a class="headerlink" href="#data-format" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Data from Datastream is not panel data format</p></li>
</ul>
<p><img alt="" src="https://raw.githubusercontent.com/mk0417/image-lib/master/ds_data.png" /></p>
<ul class="simple">
<li><p>We need to transpose data from wide to long before we analyse the data</p></li>
</ul>
<p>Let’s assume we have stock price data for two firms.</p>
<p><img alt="" src="https://raw.githubusercontent.com/mk0417/image-lib/master/wide_to_long.png" /></p>
</section>
</section>
<section id="python">
<h2>Python<a class="headerlink" href="#python" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Read firm assets from Datastream</p></li>
</ul>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.dropbox.com/s/3x230qb3fkopij3/datastream_asset.xlsx?dl=1&#39;</span>
<span class="n">asset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;asset&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<ul class="simple">
<li><p>Transpose data</p></li>
</ul>
<div class="jupyter_cell jupyter_container docutils container">
<div class="cell_input code_cell docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">asset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">asset</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="s1">&#39;Code&#39;</span><span class="p">,</span> <span class="n">value_vars</span><span class="o">=</span><span class="n">asset</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
    <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;asset&#39;</span><span class="p">)</span>
<span class="n">asset</span><span class="p">[</span><span class="s1">&#39;isin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">asset</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">12</span><span class="p">]</span>
<span class="n">asset</span> <span class="o">=</span> <span class="n">asset</span><span class="p">[[</span><span class="s1">&#39;isin&#39;</span><span class="p">,</span><span class="s1">&#39;Code&#39;</span><span class="p">,</span><span class="s1">&#39;asset&#39;</span><span class="p">]]</span>
<span class="n">asset</span> <span class="o">=</span> <span class="n">asset</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Code&#39;</span><span class="p">:</span> <span class="s1">&#39;year&#39;</span><span class="p">})</span>
<span class="n">asset</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>isin</th>
      <th>year</th>
      <th>asset</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>US0378331005</td>
      <td>2000</td>
      <td>6803000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>US0378331005</td>
      <td>2001</td>
      <td>6021000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>US0378331005</td>
      <td>2002</td>
      <td>6228000.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>US0378331005</td>
      <td>2003</td>
      <td>6755000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>US0378331005</td>
      <td>2004</td>
      <td>7964000.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="stata">
<h2>Stata<a class="headerlink" href="#stata" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Read firm assets from Datastream</p></li>
</ul>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Import firm total asset */</span><span class="k"></span>
<span class="k">local</span> data_url <span class="s">&quot;https://www.dropbox.com/s/3x230qb3fkopij3/datastream_asset.xlsx?dl=1&quot;</span>
import excel using <span class="s">&quot;</span><span class="nv">`data_url&#39;</span><span class="s">&quot;</span>, sheet(<span class="s">&quot;asset&quot;</span>) first<span class="k"> clear</span>

<span class="cm">/* Rename variables */</span><span class="k"></span>
<span class="k">rename</span> Code year

<span class="k">rename</span> US<span class="o">*</span> assetUS<span class="o">*</span>

<span class="cm">/* Convert data type */</span><span class="k"></span>
<span class="k">destring</span>,<span class="k"> replace</span> ignore(<span class="s">&quot;NA&quot;</span>)
</pre></div>
</div>
<ul class="simple">
<li><p>Transpose data</p></li>
</ul>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="cm">/* Reshape wide to long */</span><span class="k"></span>
<span class="k">reshape</span> long asset, i(year) j(isin) string

<span class="cm">/* Extract ISIN */</span><span class="k"></span>
<span class="k">replace</span> isin = <span class="nf">substr</span>(isin, <span class="m">1</span>, <span class="m">12</span>)
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Class04</a><ul>
<li><a class="reference internal" href="#datastream">Datastream</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#access">Access</a><ul>
<li><a class="reference internal" href="#where-to-find-eikon-terminal">Where to find Eikon terminal</a></li>
<li><a class="reference internal" href="#how-to-login">How to login</a></li>
</ul>
</li>
<li><a class="reference internal" href="#company-list">Company list</a><ul>
<li><a class="reference internal" href="#how-to-screen-company-list">How to screen company list</a></li>
<li><a class="reference internal" href="#company-list-from-other-database">Company list from other database</a></li>
</ul>
</li>
<li><a class="reference internal" href="#static-data">Static data</a></li>
<li><a class="reference internal" href="#time-series-data">Time series data</a></li>
<li><a class="reference internal" href="#data-format">Data format</a></li>
</ul>
</li>
<li><a class="reference internal" href="#python">Python</a></li>
<li><a class="reference internal" href="#stata">Stata</a></li>
</ul>
</li>
</ul>

  </div><h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation index</a><ul>
      <li>Previous: <a href="class03.html" title="previous chapter">Class03</a></li>
      <li>Next: <a href="class05.html" title="next chapter">Class05</a></li>
  </ul></li>
</ul>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/class04.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="class05.html" title="Class05"
             >next</a> |</li>
        <li class="right" >
          <a href="class03.html" title="Class03"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Database and Data Management</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Class04</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
      <p>
        &copy; Copyright 2021, Peng.
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.
      </p>
    </div>
  </body>
</html>